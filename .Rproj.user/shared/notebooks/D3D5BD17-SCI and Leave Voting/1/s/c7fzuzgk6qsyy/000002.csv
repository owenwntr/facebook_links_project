"0",""
"0","df <- data.frame(user_loc = unique(countries_fromuk$user_loc))"
"0",""
"0","for (country in unique(countries_fromuk$fr_country)){"
"0","  df[country] <- NA"
"0","  for (region in unique(countries_fromuk$user_loc)){"
"0","    df[which(df$user_loc==region),country] = log(countries_fromuk[which((countries_fromuk$user_loc==region)&(countries_fromuk$fr_country==country)),""weighted_mean""][[1]])"
"0","  }"
"0","}"
"0",""
"0","df.pca <- prcomp(df[,c(2:200)], center = TRUE,scale. = FALSE)"
"0",""
"0","biplot <- ggbiplot(df.pca, labels=df$user_loc,"
"0","        labels.size = 1,varname.size = 1,"
"0","        var.scale=1, var.size=1,varname.adjust=10, width=0.1) +"
"0","  theme_minimal() +"
"0","  theme(axis.text=element_text(size=6),"
"0","        axis.title=element_text(size=6))"
"0",""
"0","biplot[[""layers""]][[1]][[""aes_params""]][[""size""]] <- 0.1"
"0","biplot[[""layers""]][[1]][[""geom_params""]][[""arrow""]][[""length""]] <- ggplot2::unit(0.1, ""picas"")"
"0",""
"0","biplot"
"0",""
